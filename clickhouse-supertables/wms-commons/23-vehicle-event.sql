-- ClickHouse table for WMS Vehicle Event
-- Dimension table for Vehicle Event information
-- Source: samadhan_prod.wms.public.vehicle_event

CREATE TABLE IF NOT EXISTS wms_vehicle_event
(
    whId Int64 DEFAULT 0,
    id String DEFAULT '', 
    vehicleId String DEFAULT '',
    vehicleNo String DEFAULT '',
    vehicleType String DEFAULT '',
    gatingEnabled Bool DEFAULT false,
    attrs String DEFAULT '{}',
    status String DEFAULT '',
    sessionId String DEFAULT '',
    sessionKind String DEFAULT '',
    gateReportedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    gateInAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    gateOutAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    dockdoorId String DEFAULT '',
    dockdoorCode String DEFAULT '',
    dockdoorQueue Int32 DEFAULT 0,
    dockInAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    dockOutAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    createdAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    updatedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    active Bool DEFAULT false,
    parkingSlotId String DEFAULT '',
    parkingSlotAssignedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    gatePassCode String DEFAULT '',
    undockedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    transporterCode String DEFAULT '',
    originalVehicle String DEFAULT '',
    shipmentTypes String DEFAULT '[]',
    isSealCaptureSuccessful Bool DEFAULT false,
    sealCapturedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    sealCaptureImages String DEFAULT '[]',
    sealCaptureRemarks String DEFAULT '',
    driverName String DEFAULT '',
    driverNumber String DEFAULT '',
    isDockingRejected Bool DEFAULT false,
    dockingRejectedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    dockingRejectedBy Int64 DEFAULT 0,
    dockingRejectionRemark String DEFAULT '',
    dockingRejectionImages String DEFAULT '[]',
    fleetType String DEFAULT '',
    loadType String DEFAULT '',
    entryWeight Float64 DEFAULT 0.0,
    exitWeight Float64 DEFAULT 0.0,
    entryTemp Float64 DEFAULT 0.0,
    exitTemp Float64 DEFAULT 0.0,
    dockRejectedByApp String DEFAULT '',
    oldDriverName String DEFAULT '',
    oldDriverNumber String DEFAULT '',
    commonQueue Int32 DEFAULT 0,
    gatingQueue Int32 DEFAULT 0,
    sealCapturedBy Int64 DEFAULT 0,
    sealCapturedByApp String DEFAULT '',
    lrNumber String DEFAULT '',
    certificateVerificationStatus String DEFAULT '',
    certificateVerificationReason String DEFAULT '',
    driverSafetyTestResultId String DEFAULT '',
    documentCollectionMode String DEFAULT '',
    documentCollectedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    processingStartedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    processingEndedAt DateTime64(3) DEFAULT toDateTime64('1970-01-01 00:00:00', 3),
    manualTrips String DEFAULT '[]'
)
ENGINE = ReplacingMergeTree(updatedAt)
PARTITION BY toYYYYMM(createdAt)
ORDER BY (id)
SETTINGS index_granularity = 8192;