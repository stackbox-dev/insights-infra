CREATE TABLE IF NOT EXISTS sbx_uat.skus_master
(
    id String,
    principal_id Int64,
    node_id Int64,
    category String,
    product String,
    category_group String,
    sub_brand String,
    brand String,
    code String,
    name String,
    short_description String,
    description String,
    fulfillment_type String,
    avg_l0_per_put Int32,
    inventory_type String,
    shelf_life Int32,
    identifier1 String,
    identifier2 String,
    tag1 String,
    tag2 String,
    tag3 String,
    tag4 String,
    tag5 String,
    tag6 String,
    tag7 String,
    tag8 String,
    tag9 String,
    handling_unit_type String,
    cases_per_layer Int32,
    layers Int32,
    active_from String,
    active_till String,
    l0_units Int32,
    l1_units Int32,
    l2_units Int32,
    l2_units_final Int32,
    l3_units Int32,
    l3_units_final Int32,
    l0_name String,
    l0_weight Float64,
    l0_volume Float64,
    l0_package_type String,
    l0_length Float64,
    l0_width Float64,
    l0_height Float64,
    l0_packing_efficiency Float64,
    l0_itf_code String,
    l0_erp_weight Float64,
    l0_erp_volume Float64,
    l0_erp_length Float64,
    l0_erp_width Float64,
    l0_erp_height Float64,
    l0_text_tag1 String,
    l0_text_tag2 String,
    l0_image String,
    l0_num_tag1 Float64,
    l1_name String,
    l1_weight Float64,
    l1_volume Float64,
    l1_package_type String,
    l1_length Float64,
    l1_width Float64,
    l1_height Float64,
    l1_packing_efficiency Float64,
    l1_itf_code String,
    l1_erp_weight Float64,
    l1_erp_volume Float64,
    l1_erp_length Float64,
    l1_erp_width Float64,
    l1_erp_height Float64,
    l1_text_tag1 String,
    l1_text_tag2 String,
    l1_image String,
    l1_num_tag1 Float64,
    l2_name String,
    l2_weight Float64,
    l2_volume Float64,
    l2_package_type String,
    l2_length Float64,
    l2_width Float64,
    l2_height Float64,
    l2_packing_efficiency Float64,
    l2_itf_code String,
    l2_erp_weight Float64,
    l2_erp_volume Float64,
    l2_erp_length Float64,
    l2_erp_width Float64,
    l2_erp_height Float64,
    l2_text_tag1 String,
    l2_text_tag2 String,
    l2_image String,
    l2_num_tag1 Float64,
    l3_name String,
    l3_weight Float64,
    l3_volume Float64,
    l3_package_type String,
    l3_length Float64,
    l3_width Float64,
    l3_height Float64,
    l3_packing_efficiency Float64,
    l3_itf_code String,
    l3_erp_weight Float64,
    l3_erp_volume Float64,
    l3_erp_length Float64,
    l3_erp_width Float64,
    l3_erp_height Float64,
    l3_text_tag1 String,
    l3_text_tag2 String,
    l3_image String,
    l3_num_tag1 Float64,
    active Bool,
    classifications String,
    product_classifications String,
    is_deleted Bool
) 
ENGINE = ReplacingMergeTree()
ORDER BY (principal_id, code);

-- Add TTL for auto-deletion of deleted records
ALTER TABLE sbx_uat.encarta.public.skus_master
ADD TTL toDateTime(0) + INTERVAL 1 MINUTE DELETE
WHERE is_deleted = 1;