CREATE TABLE IF NOT EXISTS sbx_uat.skus_master
(
    id String,
    principal_id Int64 DEFAULT 0,
    node_id Int64 DEFAULT 0,
    category String DEFAULT '',
    product String DEFAULT '',
    category_group String DEFAULT '',
    sub_brand String DEFAULT '',
    brand String DEFAULT '',
    code String DEFAULT '',
    name String DEFAULT '',
    short_description String DEFAULT '',
    description String DEFAULT '',
    fulfillment_type String DEFAULT '',
    avg_l0_per_put Int32 DEFAULT 0,
    inventory_type String DEFAULT '',
    shelf_life Int32 DEFAULT 0,
    identifier1 String DEFAULT '',
    identifier2 String DEFAULT '',
    tag1 String DEFAULT '',
    tag2 String DEFAULT '',
    tag3 String DEFAULT '',
    tag4 String DEFAULT '',
    tag5 String DEFAULT '',
    tag6 String DEFAULT '',
    tag7 String DEFAULT '',
    tag8 String DEFAULT '',
    tag9 String DEFAULT '',
    handling_unit_type String DEFAULT '',
    cases_per_layer Int32 DEFAULT 0,
    layers Int32 DEFAULT 0,
    active_from String DEFAULT '',
    active_till String DEFAULT '',
    l0_units Int32 DEFAULT 0,
    l1_units Int32 DEFAULT 0,
    l2_units Int32 DEFAULT 0,
    l2_units_final Int32 DEFAULT 0,
    l3_units Int32 DEFAULT 0,
    l3_units_final Int32 DEFAULT 0,
    l0_name String DEFAULT '',
    l0_weight Float64 DEFAULT 0,
    l0_volume Float64 DEFAULT 0,
    l0_package_type String DEFAULT '',
    l0_length Float64 DEFAULT 0,
    l0_width Float64 DEFAULT 0,
    l0_height Float64 DEFAULT 0,
    l0_packing_efficiency Float64 DEFAULT 0,
    l0_itf_code String DEFAULT '',
    l0_erp_weight Float64 DEFAULT 0,
    l0_erp_volume Float64 DEFAULT 0,
    l0_erp_length Float64 DEFAULT 0,
    l0_erp_width Float64 DEFAULT 0,
    l0_erp_height Float64 DEFAULT 0,
    l0_text_tag1 String DEFAULT '',
    l0_text_tag2 String DEFAULT '',
    l0_image String DEFAULT '',
    l0_num_tag1 Float64 DEFAULT 0,
    l1_name String DEFAULT '',
    l1_weight Float64 DEFAULT 0,
    l1_volume Float64 DEFAULT 0,
    l1_package_type String DEFAULT '',
    l1_length Float64 DEFAULT 0,
    l1_width Float64 DEFAULT 0,
    l1_height Float64 DEFAULT 0,
    l1_packing_efficiency Float64 DEFAULT 0,
    l1_itf_code String DEFAULT '',
    l1_erp_weight Float64 DEFAULT 0,
    l1_erp_volume Float64 DEFAULT 0,
    l1_erp_length Float64 DEFAULT 0,
    l1_erp_width Float64 DEFAULT 0,
    l1_erp_height Float64 DEFAULT 0,
    l1_text_tag1 String DEFAULT '',
    l1_text_tag2 String DEFAULT '',
    l1_image String DEFAULT '',
    l1_num_tag1 Float64 DEFAULT 0,
    l2_name String DEFAULT '',
    l2_weight Float64 DEFAULT 0,
    l2_volume Float64 DEFAULT 0,
    l2_package_type String DEFAULT '',
    l2_length Float64 DEFAULT 0,
    l2_width Float64 DEFAULT 0,
    l2_height Float64 DEFAULT 0,
    l2_packing_efficiency Float64 DEFAULT 0,
    l2_itf_code String DEFAULT '',
    l2_erp_weight Float64 DEFAULT 0,
    l2_erp_volume Float64 DEFAULT 0,
    l2_erp_length Float64 DEFAULT 0,
    l2_erp_width Float64 DEFAULT 0,
    l2_erp_height Float64 DEFAULT 0,
    l2_text_tag1 String DEFAULT '',
    l2_text_tag2 String DEFAULT '',
    l2_image String DEFAULT '',
    l2_num_tag1 Float64 DEFAULT 0,
    l3_name String DEFAULT '',
    l3_weight Float64 DEFAULT 0,
    l3_volume Float64 DEFAULT 0,
    l3_package_type String DEFAULT '',
    l3_length Float64 DEFAULT 0,
    l3_width Float64 DEFAULT 0,
    l3_height Float64 DEFAULT 0,
    l3_packing_efficiency Float64 DEFAULT 0,
    l3_itf_code String DEFAULT '',
    l3_erp_weight Float64 DEFAULT 0,
    l3_erp_volume Float64 DEFAULT 0,
    l3_erp_length Float64 DEFAULT 0,
    l3_erp_width Float64 DEFAULT 0,
    l3_erp_height Float64 DEFAULT 0,
    l3_text_tag1 String DEFAULT '',
    l3_text_tag2 String DEFAULT '',
    l3_image String DEFAULT '',
    l3_num_tag1 Float64 DEFAULT 0,
    active Bool DEFAULT FALSE,
    classifications String DEFAULT '',
    product_classifications String DEFAULT '',
    is_deleted Bool DEFAULT FALSE,
    deleted_at DateTime DEFAULT now()
) 
ENGINE = ReplacingMergeTree()
ORDER BY (principal_id, node_id, code)
TTL deleted_at + INTERVAL 1 MINUTE DELETE
WHERE is_deleted = 1;