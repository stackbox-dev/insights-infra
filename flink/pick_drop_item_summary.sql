-- Create final summary table structure
CREATE TABLE `sbx-uat.wms.public.pick_drop_item_summary`
(
    pick_item_id STRING,
    whId BIGINT,
    picked_bin STRING,
    picked_sku STRING,
    picked_batch STRING,
    picked_uom STRING,
    picked_qty STRING,
    overallQty INT,
    qty INT,
    huCode STRING,
    destinationBinCode STRING,
    pick_item_created_at TIMESTAMP(3),
    pickedQty INT,
    pickedAt TIMESTAMP(3),
    worker_code STRING,
    movedAt TIMESTAMP(3),
    processedAt TIMESTAMP(3),
    picked_hu_eq_uom STRING,
    picked_has_inner_hus BOOLEAN,
    picked_inner_hu_eq_uom STRING,
    picked_bin_assigned_at TIMESTAMP(3),
    scanSourceHUKind STRING,
    pickSourceHUKind STRING,
    carrierHUKind STRING,
    scannedSourceHUCode STRING,
    pickedSourceHUCode STRING,
    carrierHUCode STRING,
    huKind STRING,
    sourceHUEqUOM STRING,
    pick_item_updated_at TIMESTAMP(3),
    eligibleDropLocations STRING,
    parentItemId STRING,
    oldBatch STRING,
    destBucket STRING,
    lmTripId STRING,
    picked_inner_hu_code STRING,
    picked_inner_hu_kind_code STRING,
    picked_quant_bucket STRING,
    pick_auto_complete BOOLEAN,
    pickHU BOOLEAN,
    shortAllocationReason STRING,
    drop_item_previous_task_id STRING,
    dropItemId STRING,
    dropped_sku STRING,
    dropped_batch STRING,
    dropped_uom STRING,
    drop_bucket STRING,
    dropped_qty INT,
    picked_hu_code STRING,
    dropped_bin_code STRING,
    droppedQty INT,
    droppedAt TIMESTAMP(3),
    drop_item_updated_at TIMESTAMP(3),
    dropHUInBin BOOLEAN,
    scanDestHU BOOLEAN,
    allowHUBreak BOOLEAN,
    dropped_has_inner_hus BOOLEAN,
    scanInnerHUs BOOLEAN,
    dropped_hu_eq_uom STRING,
    destHUCode STRING,
    hu_code STRING,
    dropped_inner_hu_eq_uom STRING,
    dest_bin_assigned_at TIMESTAMP(3),
    dropUOM STRING,
    drop_parent_item_id STRING,
    huBroken BOOLEAN,
    originalSourceBinCode STRING,
    processedForLoadingAt TIMESTAMP(3),
    drop_quant_bucket STRING,
    dropped_inner_hu_code STRING,
    dropped_inner_hu_kind_code STRING,
    dropInnerHU BOOLEAN,
    allowInnerHUBreak BOOLEAN,
    innerHUBroken BOOLEAN,
    drop_auto_complete BOOLEAN,
    quantSlottingForHUs BOOLEAN,
    processedOnDropAt TIMESTAMP(3),
    allowHUBreakV2 BOOLEAN,
    task_kind STRING,
    task_code STRING,
    task_sequence INT,
    task_state STRING,
    task_attrs STRING,
    task_progress STRING,
    task_created_at TIMESTAMP(3),
    task_updated_at TIMESTAMP(3),
    allowForceComplete BOOLEAN,
    wave INT,
    forceCompleted BOOLEAN,
    task_subkind STRING,
    `label` STRING,
    session_kind STRING,
    session_code STRING,
    session_attrs STRING,
    session_created_at TIMESTAMP(3),
    session_updated_at TIMESTAMP(3),
    active BOOLEAN,
    session_state STRING,
    session_progress STRING,
    session_auto_complete BOOLEAN,
    worker_attrs STRING,
    worker_name STRING,
    supervisor BOOLEAN,
    product_code STRING,
    principal_id BIGINT,
    sku_id STRING,
    sku_code STRING,
    category STRING,
    classvalue STRING,
    node_id BIGINT,
    node_override_class STRING,
    finalclass STRING,
    encarta_uom_id STRING,
    encarta_uom_code STRING,
    ibc STRING,
    casecount STRING,
    pallet_count STRING,
    lm_trip_code STRING,
    lm_trip_priority  INT,
    lm_dockdoor STRING,
    lm_vehicle_no STRING,
    lm_vehicle_type STRING,
    lm_delivery_date DATE,
    xdock STRING,
    mm_trip_code STRING,
    mm_trip_priority INT,
    mm_dockdoor STRING,
    mm_vehicle_no STRING,
    mm_vehicle_type STRING,
    mm_delivery_date DATE
    PRIMARY KEY (pick_item_id, dropItemId) NOT ENFORCED
) WITH (
    'connector' = 'confluent',
    'value.format' = 'avro-registry'
);

-- Continuously populate the summary table
